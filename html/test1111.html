<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Start Up</title>
    <style type="text/css">
    .img_wrap{
        width: 300px;
        height: 300px;
        margin-top: 50px;
    }
    .img_wrap img{
        max-height: 300px;
        max-width: 300px;
        
    }

</style>
<script
src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
    var sel_files=[];
    $(document).ready(function(){
        var i = 1;
        $(".input_img"+i).on("change", handleImgFileSelect);
        console.log(i);
        console.log("aaaaaaaaaa");
        i++;
        console.log(i);
    });
    
    function handleImgFileSelect(e){
        
        var files = e.target.files;
        var filesArr = Array.prototype.slice.call(files);
        var a = 1;

        filesArr.forEach(function(f)
        {
            if(!f.type.match("image.*")){
                alert("확장자는");
                return;
            }

            sel_files = f;

            var reader = new FileReader();
            reader.onload = function(e){
                $('#img'+a).attr("src", e.target.result);
                a++;
                console.log(a);
            }
            reader.readAsDataURL(f);
        });
    }

</script>
<script>
    $(document).ready(function(){
        var i = 2;
        $("#test").on('click', function(){
            
            console.log("aaaaaaaaaa");
            $(".imgs_wrap1").append("<div class='imgs_wrap"+i+"'><h2><b>미리보기</b></h2><p class='title'>이미지업로드</p><input type='file' class='input_img"+i+"'/></div><div><div class='img_wrap'><img id='img"+i+"'/></div></div>");
            i++;
        }); 
    });
</script>

<script>
    $(document).ready(function(){

    });
    

</script>

</head>
<body>
    <div class="imgs_wrap1">
        <h2><b>미리보기</b></h2>
        <p class="title">이미지업로드</p>
        <input type="file" class="input_img1"/>
        <div >
            <div class="img_wrap">
                <img id="img1"/>
            </div>
        </div>
    </div>


    <div>
        <button id="test">테스트</button>
    </div>
</body>
</html>